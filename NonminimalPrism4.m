clear; clc; clf; figure(1);

theta = 0* (pi/180); %rotation of the top plane with respect to the bottom plane
R = [cos(theta), 0, -sin(theta); 0, 1, 0; sin(theta), 0, cos(theta)]; 
% 8 nodes in the structure
n0=[-1,0,-1];
n1=[-1,0,1];
n2=[1,0,1];
n3=[1,0,-1];
n4= [-1,2,-1]*R ;
n5= [-1,2,1]*R ;
n6= [1,2,1]*R ;
n7= [1,2,-1]*R ;
N=[n0;n1;n2;n3;n4;n5;n6;n7]';
%connectivity matrix
C(  1,1)=-1;  C( 1,2)=0; C(  1,3)=0; C(  1,4)=0; C(  1,5)=0; C( 1,6)=0; C(  1,7)=1; C(  1,8)=0;
C(  2,1)=0;  C( 2,2)=-1; C(  2,3)=0; C(  2,4)=0; C(  2,5)=0; C( 2,6)=0; C(  2,7)=0; C(  2,8)=1;
C(  3,1)=0;  C( 3,2)=0; C(  3,3)=-1; C(  3,4)=0; C(  3,5)=1; C( 3,6)=0; C(  3,7)=0; C(  3,8)=0;
 C(  4,1)=0;  C( 4,2)=0; C(  4,3)=0; C(  4,4)=-1; C(  4,5)=0; C( 4,6)=1; C(  4,7)=0; C(  4,8)=0;
 C(  5,1)=-1;  C( 5,2)=0; C(  5,3)=1; C(  5,4)=0; C(  5,5)=0; C( 5,6)=0; C(  5,7)=0; C(  5,8)=0;
 C(  6,1)=0;  C( 6,2)=-1; C(  6,3)=0; C(  6,4)=1; C(  6,5)=0; C( 6,6)=0; C(  6,7)=0; C(  6,8)=0;
C(  7,1)=-1;  C( 7,2)=0; C(  7,3)=0; C(  7,4)=0; C(  7,5)=0; C( 7,6)=1; C(  7,7)=0; C(  7,8)=0;
C(  8,1)=0;  C( 8,2)=-1; C(  8,3)=0; C(  8,4)=0; C(  8,5)=1; C( 8,6)=0; C(  8,7)=0; C(  8,8)=0;
C(  9,1)=0;  C( 9,2)=-1; C(  9,3)=0; C(  9,4)=0; C(  9,5)=0; C( 9,6)=0; C(  9,7)=1; C(  9,8)=0;
C(  10,1)=0;  C( 10,2)=0; C(  10,3)=-1; C(  10,4)=0; C(  10,5)=0; C( 10,6)=1; C(  10,7)=0; C(  10,8)=0;
C(  11,1)=0;  C( 11,2)=0; C(  11,3)=-1; C(  11,4)=0; C(  11,5)=0; C( 11,6)=0; C(  11,7)=0; C(  11,8)=1;
C(  12,1)=0;  C( 12,2)=0; C(  12,3)=0; C(  12,4)=-1; C(  12,5)=0; C( 12,6)=0; C(  12,7)=1; C(  12,8)=0;
C(  13,1)=-1;  C( 13,2)=0; C(  13,3)=0; C(  13,4)=0; C(  13,5)=0; C( 13,6)=0; C(  13,7)=0; C(  13,8)=1;
C(  14,1)=0;  C( 14,2)=0; C(  14,3)=0; C(  14,4)=-1; C(  14,5)=1; C( 14,6)=0; C(  14,7)=0; C(  14,8)=0;
C(  15,1)=0;  C( 15,2)=0; C(  15,3)=0; C(  15,4)=0; C(  15,5)=0; C( 15,6)=-1; C(  15,7)=0; C(  15,8)=1;
C(  16,1)=0;  C( 16,2)=0; C(  16,3)=0; C(  16,4)=0; C(  16,5)=-1; C( 16,6)=0; C(  16,7)=1; C(  16,8)=0;
C(  17,1)=-1;  C( 17,2)=1; C(  17,3)=0; C(  17,4)=0; C(  17,5)=0; C( 17,6)=0; C(  17,7)=0; C(  17,8)=0;
C(  18,1)=0;  C( 18,2)=-1; C(  18,3)=1; C(  18,4)=0; C(  18,5)=0; C( 18,6)=0; C(  18,7)=0; C(  18,8)=0;
C(  19,1)=0;  C( 19,2)=0; C(  19,3)=-1; C(  19,4)=1; C(  19,5)=0; C( 19,6)=0; C(  19,7)=0; C(  19,8)=0;
C(  20,1)=1;  C( 20,2)=0; C(  20,3)=0; C(  20,4)=-1; C(  20,5)=0; C( 20,6)=0; C(  20,7)=0; C(  20,8)=0;
C(  21,1)=-1;  C( 21,2)=0; C(  21,3)=0; C(  21,4)=0; C(  21,5)=1; C( 21,6)=0; C(  21,7)=0; C(  21,8)=0;
C(  22,1)=0;  C( 22,2)=-1; C(  22,3)=0; C(  22,4)=0; C(  22,5)=0; C( 22,6)=1; C(  22,7)=0; C(  22,8)=0;
C(  23,1)=0;  C( 23,2)=0; C(  23,3)=-1; C(  23,4)=0; C(  23,5)=0;  C( 23,6)=0; C(  23,7)=1; C(  23,8)=0;
C(  24,1)=0;  C( 24,2)=0; C(  24,3)=0; C(  24,4)=-1; C(  24,5)=0;  C( 24,6)=0; C(  24,7)=0; C(  24,8)=1;
C(  25,1)=0;  C( 25,2)=0; C(  25,3)=0; C(  25,4)=0; C(  25,5)=-1;  C( 25,6)=1; C(  25,7)=0; C(  25,8)=0;
C(  26,1)=0;  C( 26,2)=0; C(  26,3)=0; C(  26,4)=0; C(  26,5)=0;  C( 26,6)=-1; C(  26,7)=1; C(  26,8)=0;
C(  27,1)=0;  C( 27,2)=0; C(  27,3)=0; C(  27,4)=0; C(  27,5)=0;  C( 27,6)=0; C(  27,7)=-1; C(  27,8)=1;
C(  28,1)=0;  C( 28,2)=0; C(  28,3)=0; C(  28,4)=0; C(  28,5)=1;  C( 28,6)=0; C(  28,7)=0; C(  28,8)=-1;

Q=N;
P=[];

% INPUTS:
b=4;
s=24;
dim=3;
q=8; %=locations of free nodes
p=0;%=locations of fixed nodes


U=zeros(dim,q); %=applied external force vector at each free node
U(:,1)=[0;0;0];
U(:,2)=[0;0;0];
U(:,3)=[0;0;0];
U(:,4)=[0;0;0];
U(:,5)=[0;0;0];
U(:,6)=[0;0;0];
U(:,7)=[0;0;0];
U(:,8)=[0;0;0];


[c_bars,t_strings,V]=tensegrity_statics(b,s,q,p,dim,Q,P,C,U);
tensegrity_plot(Q,P,C,b,s,U,V,true,2.0); grid on;
